<p id="notice"><%= notice %></p>

<% firstday = Date.new(2018,12,28) %>
<% today = Date.today  %>

<% if  current_member.membership.name != "Operator"%>
  

  <h1>Reservations</h1>

  <table class="table-striped" >
    <thead>
      <tr>
        <th></th>
        <th>Day</th>
        <th>Time</th>
        <th>Lesson/Practice</th>
      </tr>
    </thead>

    <tbody>
      <% @reservations.each do |reservation| %>
        <tr>

        <% if reservation.day.name >= today  %>
            

         <td> <%= link_to cancel_reservation_path(reservation)  do %> 
              <i class="glyphicon glyphicon-trash "></i>   
              <% end %> 
         </td>

          <td><%= reservation.day.name.strftime("%a %b %-d '%y") %></td>        
          <td><%= reservation.timeslot.start.strftime("%H:%M") %></td>        
          <td><%= reservation.activity.name %></td>        
        </tr>


       <% end %>


      <% end %>
    </tbody>
  </table>

<% end %>


<% if  current_member.membership.name == "Operator"%>
  

  <h1>Lessons</h1>

  <table class="table-striped" >
    <thead>
      <tr>
        <th></th>
        <th>Day</th>
        <th>Time</th>
        <th>Member</th>
        <th>Lesson/Practice</th>
      </tr>
    </thead>

    <tbody>
      <% @reservations.each do |reservation| %>
        <tr>

        <% if reservation.day.name >= today  %>
            

         <td> <%= link_to cancel_reservation_path(reservation)  do %> 
              <i class="glyphicon glyphicon-trash "></i>   
              <% end %> 
         </td>

          <td><%= reservation.day.name.strftime("%a %b %-d '%y") %></td>        
          <td><%= reservation.timeslot.start.strftime("%H:%M") %></td>        
          <td><%= reservation.member.lastname %>, <%= reservation.member.firstname %></td>        
          <td><%= reservation.activity.name %></td>        
        </tr>


       <% end %>


      <% end %>
    </tbody>
  </table>

<% end %>







<h1>Schedule</h1>

<table class="table-striped"  >
  <thead>
    <tr>
      <th>Date</th>
      <th>Bookings</th>
      <th>Status</th>
    </tr>
  </thead>






  <tbody>
    <% @days.each do |day| %>

    <% if day.name < today %>
      <tr style="color:red; text-decoration: line-through;">
    <% else %>
      <tr>

    <% end %>


    <% if day.open_close.name == "Closed" %>
      <td style="color:red;">
    <% else %>
      <td>      
    <% end %>
        <%= day.name.strftime("%a %b %-d '%y")   %> </td>
        
  


    <% if day.open_close.name == "Open" %>
      <% if day.reservations.where('member_id = ?',current_member.id).count > 0 %>
        <td> <%= link_to day  do %> 
           <i class="glyphicon glyphicon-check "></i>   
           <% end %> 
        </td>
      <% else %>
        <td> <%= link_to day  do %> 
           <i class="glyphicon glyphicon-unchecked "></i>   
           <% end %> 
        </td>
      <% end %>

    <% else %>
      <td></td>
      
    <% end %>



        <% if current_member.membership.name == "Admin" or current_member.membership.name == "Operator"  %>

          <td> <%= link_to toggle_open_close_status_day_path(day)  do %> 
            <% if day.open_close.name == "Open"  %>
              <span class="greendot"></span></td>
            <% else %>                  
              <span class="reddot"></span></td>                                    
            <% end %>
          <% end %>   
          
        <% else %>
          <% if day.open_close.name == "Open" %>

            <td><span class="greendot"></span></td>
          <% else %>                  
            <td><span class="reddot"></span></td>                      
          <% end %>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
<br>











